
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NCK CBT Simulation</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
    }
    header {
      background: #002147;
      color: white;
      padding: 1rem 2rem;
      text-align: center;
    }
    .tab-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      background: #f0f0f0;
      padding: 10px;
      border-bottom: 2px solid #ccc;
    }
    .tab-btn {
      margin: 5px;
      padding: 10px 16px;
      border: none;
      background: #ccc;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
      transition: 0.2s ease-in-out;
    }
    .tab-btn.active {
      background: #002147;
      color: white;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .question-box {
      margin-bottom: 20px;
    }
    .btn {
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      font-size: 16px;
      cursor: pointer;
      background: #e0e0e0;
      border: none;
      border-radius: 4px;
      text-align: left;
    }
    .btn:hover { background: #d0d0d0; }
    #navigation {
      text-align: center;
      margin-top: 20px;
    }
    #navigation button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      background: #002147;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    #timer {
      text-align: center;
      font-size: 18px;
      margin-top: 10px;
      font-weight: bold;
    }
    #timer.red { color: red; }
    footer {
      text-align: center;
      font-size: 14px;
      margin-top: 50px;
      color: #777;
    }
  </style>
</head>
<body>
  <header>
    <h1>NCK CBT Exam Practice</h1>
    <p>Simulated Environment for Mock and Main Exam Preparation</p>
  </header>

  <div class="tab-bar" id="quiz-tabs"></div>
  <div class="container">
    <div id="quiz-container"></div>
    <div id="navigation"></div>
    <div id="timer">Time Left: 00:00</div>
  </div>

  <footer>Â© 2025 HEARTIQUE NURSING SIM</footer>

  <script>
    const fileList = [
      { name: "MOCK 1", file: "mock1.json", profectus: true },
      { name: "MOCK 2", file: "mock2.json", profectus: true },
      { name: "MOCK 3", file: "mock3.json", profectus: true },
      { name: "NCK 1", file: "nck1.json", profectus: true },
      { name: "NCK 2", file: "nck2.json", profectus: true },
      { name: "NCK 3", file: "nck3.json", profectus: true },
      { name: "FINAL SELF TEST", file: "final_nck_self.json", profectus: true }
    ];

    const tabsDiv = document.getElementById('quiz-tabs');
    const container = document.getElementById('quiz-container');
    const navDiv = document.getElementById('navigation');
    const timerEl = document.getElementById('timer');

    let current = 0, flagged = new Set(), questions = [], fileName = "";
    let saved = {}, timer, timeLeft;

    fileList.forEach((item, i) => {
      const btn = document.createElement('button');
      btn.className = 'tab-btn';
      btn.textContent = item.name;
      btn.onclick = () => loadQuiz(item.file, btn);
      tabsDiv.appendChild(btn);
    });

    function loadQuiz(file, activeBtn) {
      clearInterval(timer);
      timerEl.textContent = "Time Left: 00:00";
      timerEl.classList.remove("red");
      fileName = file;
      current = 0;
      flagged = new Set();
      saved = JSON.parse(localStorage.getItem("progress_" + file) || "{}");
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      activeBtn.classList.add('active');
      fetch(file).then(res => res.json()).then(data => {
        questions = data;
        startTimer(questions.length);
        render(current);
      });
    }

    function render(i) {
      const q = questions[i];
      const opts = q.options || {};
      container.innerHTML = `<div class="question-box"><strong>Question ${i + 1}:</strong><br><br>${q.question || "Untitled"}<br><br></div>`;
      const box = container.querySelector('.question-box');
      for (const [k, v] of Object.entries(opts)) {
        const b = document.createElement('button');
        b.className = 'btn';
        b.textContent = `${k}) ${v}`;
        if (saved[i]) b.disabled = true;
        b.onclick = () => {
          saved[i] = { selected: k, correct: k === (q.answer || "").toUpperCase() };
          localStorage.setItem("progress_" + fileName, JSON.stringify(saved));
          b.disabled = true;
        };
        box.appendChild(b);
      }
      if (flagged.has(i)) box.innerHTML += "<p style='color:#002147;'>[Flagged for review]</p>";
      updateNav();
    }

    function updateNav() {
      navDiv.innerHTML = `
        <button onclick="prev()">Previous</button>
        <button onclick="flag()">Flag</button>
        <button onclick="next()">Next</button>
        <button onclick="submitTest()">Submit</button>
      `;
    }

    function prev() { if (current > 0) { current--; render(current); } }
    function next() { if (current < questions.length - 1) { current++; render(current); } }
    function flag() {
      flagged.has(current) ? flagged.delete(current) : flagged.add(current);
      render(current);
    }
    function submitTest() {
      const correct = Object.values(saved).filter(x => x.correct).length;
      const total = questions.length;
      const percent = Math.round((correct / total) * 100);
      alert(`You scored ${correct} / ${total} (${percent}%)`);
      clearInterval(timer);
    }

    function startTimer(qCount) {
      let duration = Math.floor(qCount * 90); // 1.5 min per Q
      timeLeft = duration;
      updateTimer();
      timer = setInterval(() => {
        timeLeft--;
        updateTimer();
        if (timeLeft <= 0) {
          clearInterval(timer);
          submitTest();
        }
      }, 1000);
    }

    function updateTimer() {
      const min = String(Math.floor(timeLeft / 60)).padStart(2, '0');
      const sec = String(timeLeft % 60).padStart(2, '0');
      timerEl.textContent = `Time Left: ${min}:${sec}`;
      if (timeLeft <= 30) timerEl.classList.add("red");
    }
  </script>
</body>
</html>
